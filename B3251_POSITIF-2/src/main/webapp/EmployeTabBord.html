<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <style> 
            .header 
            {
                cursor: default;
                border: 3px #95BAE0 solid;
                background-color: #95BAE0;
            }
            body 
            {
                background-color: #FFFFFF;
            }
            li#bouton-voyance
            {
                float: left;
                width: 50%;
            }
            li#bouton-deconnexion {
            }
            ul
            {
                list-style: none    
            }
            
            
        </style>
        <link rel="stylesheet" href="style.css" />
        <link rel="stylesheet" href="main-layout.css" />
        <title>Positif - Tableau de Bord</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    </head>
    <body>
        <div class="toolbar">
            <button id="bouton-voyance" class="menu-btn">Voyance</button>
            <button id="bouton-stats" class="menu-btn selected">Tableau de Bord</button>
           
        </div>
       
        
        <h2> Statistiques </h2> <br>

        <div id="bloc1">
        <h3> Nombre de client par employé </h3>
       <svg width='100%' height='400px'>
            <g>
              <rect fill='#3d5599' x="100" width="45" y="50%" height="45%"></rect>  <!-- On impose que la la somme y + height  soit 95 pour laisser de la place à la légend-->
              <text  y="100%" x="100" >Emp 1</text>
              <rect fill='#3d5599' x="150" width="45" y="50%" height="45%"></rect>
              <rect fill='#3d5599' x="200" width="45" y="20%" height="75%"></rect>
              <rect fill='#3d5599' x="250" width="45" y="10%" height="85%"></rect>

              
            </g>
          </svg>
        <table id="Employe" border="1"> </table>
        </div>
        <div id="bloc2">
        <h3> Nombre de client par medium </h3>
        <!-- <div id="nom"> </div>
        <div id="nbApparition"> </div> -->
        <table id="Medium" border="1"> </table>
        </div>
        
        <script>
         
		



        function obtenirStatistiques() {

                $.ajax({
                    url: './ActionServlet',
                    method: 'GET',
                    data: {
                        action: 'statistiques'
                    },
                    dataType: 'json'
                }).done(function (data) {
                
                   $("#Employe").empty();
                   $("#Employe").append("<td> Nom </td> <td> Nombre d'Apparition </td>");
                   $("#Medium").empty();
                   $("#Medium").append("<td> Nom </td> <td> Nombre d'Apparition </td>");
         
                   $.each(data.objetsMedium, function(i,o){
                           $("#Medium").append(" <tr> <td> " + o.nomMedium + " </td> <td> " + o.MediumNbVoyanceAssocie + " </td> </tr> ");
                       });
                   
                   $.each(data.objetsEmploye, function(i,o){
                           $("#Employe").append(" <tr> <td> " + o.nomEmploye + " </td> <td> " + o.EmployeNbVoyanceAssocie + " </td> </tr> ");
                       });
                   
                }).fail( function (error) { // Appel KO => erreur a gérer

                    // Popup avec message d'erreur :
                    alert('Erreur lors de l\'appel: HTTP Code ' + error.status + ' ~ ' + error.statusText + ' ~ ' + error.getResponseHeader('Content-Type'));
                    // Message d'erreur dans la div #message :
                    $('#message').html('Erreur lors de l\'appel: HTTP Code ' + error.status + ' ~ ' + error.statusText + ' ~ ' + error.getResponseHeader('Content-Type'));

                });
            }

            $(document).ready(function () {
                // ajout d'un "handler" sur le clic du bouton de connexion
                $('#bouton-deconnexion').on('click', function () {
                    // affichage pour debugage dans la console javascript du navigateur
                    console.log('Clic sur le bouton "Déconnexion"');
                    // appel de la fonction connexion
                    window.location = "Connexion.html";
                });
                $('#bouton-voyance').on('click', function () {
                    // affichage pour debugage dans la console javascript du navigateur
                    console.log('Clic sur le bouton "Voyance"');
                    window.location = "EmployeVoyance.html";
                });
                obtenirStatistiques();

                //remplirDonnees();
            });

            
            
            
        
        </script>
    </body>
    
    
        
</html>

